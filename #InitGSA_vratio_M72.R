times <- seq(year1, (yearend + (1 - dt)), dt)
steps <- length(times)

S <- matrix(0, steps, Mnage)
SH <- matrix(0, steps, Mnage)
L <- matrix(0, steps, Mnage)
LH <- matrix(0, steps, Mnage)
I <- matrix(0, steps, Mnage)
IH <- matrix(0, steps, Mnage)
NI <- matrix(0, steps, Mnage)
NIH <- matrix(0, steps, Mnage)
R <- matrix(0, steps, Mnage)
RH <- matrix(0, steps, Mnage)
new_infect <- matrix(0, steps, Mnage)
new_infectH <- matrix(0, steps, Mnage)
new_I <- matrix(0, steps, Mnage)
new_IH <- matrix(0, steps, Mnage)
new_NI <- matrix(0, steps, Mnage)
new_NIH <- matrix(0, steps, Mnage)
new_I_react <- matrix(0, steps, Mnage)
new_IH_react <- matrix(0, steps, Mnage)
new_I_noconv <- matrix(0, steps, Mnage)
new_IH_noconv <- matrix(0, steps, Mnage)
new_NI_react <- matrix(0, steps, Mnage)
new_NIH_react <- matrix(0, steps, Mnage)
new_actv <- matrix(0, steps, Mnage)
new_actvH <- matrix(0, steps, Mnage)
new_actv_react <- matrix(0, steps, Mnage)
new_actvH_react <- matrix(0, steps, Mnage)
new_actv_inf <- matrix(0, steps, Mnage)
new_actvH_inf <- matrix(0, steps, Mnage)
new_actv_chk <- matrix(0, steps, Mnage)
new_actvH_chk <- matrix(0, steps, Mnage)
num_vac <- matrix(0, steps, Mnage)
num_vacH <- matrix(0, steps, Mnage)
CFR <- matrix(0, steps, 1)
CFRH <- matrix(0, steps, 1)
new_notif <- matrix(0, steps, Mnage)
new_notifH <- matrix(0, steps, Mnage)

newHIVS <- matrix(0, steps, Mnage)
newHIVI <- matrix(0, steps, Mnage)
newHIVL <- matrix(0, steps, Mnage)
newHIVNI <- matrix(0, steps, Mnage)
newHIVR <- matrix(0, steps, Mnage)

uH <- matrix(0, Mnage, 1)
u <- matrix(0, Mnage, 1)

uiHa2 <- matrix(0, Mnage, 1)
uniHa2 <- matrix(0, Mnage, 1)
vHa2 <- matrix(0, Mnage, 1)
pHa2 <- matrix(0, Mnage, 1)
rHa2 <- matrix(0, Mnage, 1)
uiHa <- matrix(0, Mnage, 1)
uniHa <- matrix(0, Mnage, 1)
vHa <- matrix(0, Mnage, 1)
pHa <- matrix(0, Mnage, 1)
rHa <- matrix(0, Mnage, 1)

Sv <- matrix(0, steps, Mnage)
Lv <- matrix(0, steps, Mnage)
Iv <- matrix(0, steps, Mnage)
NIv <- matrix(0, steps, Mnage)
Rv <- matrix(0, steps, Mnage)
new_Iv <- matrix(0, steps, Mnage)
new_NIv <- matrix(0, steps, Mnage)
new_Iv_noconv <- matrix(0, steps, Mnage)
new_notifv <- matrix(0, steps, Mnage)
new_actvv <- matrix(0, steps, Mnage)

SvH <- matrix(0, steps, Mnage)
LvH <- matrix(0, steps, Mnage)
IvH <- matrix(0, steps, Mnage)
NIvH <- matrix(0, steps, Mnage)
RvH <- matrix(0, steps, Mnage)
new_IvH <- matrix(0, steps, Mnage)
new_NIvH <- matrix(0, steps, Mnage)
new_IvH_noconv <- matrix(0, steps, Mnage)
new_notifvH <- matrix(0, steps, Mnage)
new_actvvH <- matrix(0, steps, Mnage)

if (run == 1) {
  S0 <- (1 - prop) * psz1900 * (ps / (sum(ps)))
  I0 <- prop * psz1900 * (ps / (sum(ps)))
  S[1, ] <- S0
  I[1, ] <- I0
} else if (run > 1) {
  S0 <- (1 - sum(prop)) * psz1900 * (ps / (sum(ps)))
  I0 <- prop[1] * psz1900 * (ps / (sum(ps)))
  NI0 <- prop[2] * psz1900 * (ps / (sum(ps)))
  L0 <- prop[3] * psz1900 * (ps / (sum(ps)))
  R0 <- prop[4] * psz1900 * (ps / (sum(ps)))
  S[1, ] <- S0
  I[1, ] <- I0
  NI[1, ] <- NI0
  L[1, ] <- L0
  R[1, ] <- R0
}

psize <- matrix(0, steps, 1)
psizeH <- matrix(0, steps, 1)
psizeALL <- matrix(0, steps, 1)
psize014 <- matrix(0, steps, 1)
psize1554 <- matrix(0, steps, 1)
psize5564 <- matrix(0, steps, 1)
psize65plus <- matrix(0, steps, 1)
psize1559 <- matrix(0, steps, 1)
psize1529 <- matrix(0, steps, 1)
psize3044 <- matrix(0, steps, 1)
psize4559 <- matrix(0, steps, 1)
psize60plus <- matrix(0, steps, 1)
psize55plus <- matrix(0, steps, 1)
psize55minus <- matrix(0, steps, 1)
psize0509 <- matrix(0, steps, 1)
psize1019 <- matrix(0, steps, 1)
psize2029 <- matrix(0, steps, 1)
psize3039 <- matrix(0, steps, 1)
psize4049 <- matrix(0, steps, 1)
psize5059 <- matrix(0, steps, 1)
psize6069 <- matrix(0, steps, 1)
psize70plus <- matrix(0, steps, 1)
psize5574 <- matrix(0, steps, 1)
psize75plus <- matrix(0, steps, 1)
psize1524 <- matrix(0, steps, 1)
psize2554 <- matrix(0, steps, 1)
psize15plus <- matrix(0, steps, 1)
psize1549 <- matrix(0, steps, 1)

psizeVX <- matrix(0, steps, 1)
psizeVX9 <- matrix(0, steps, 1)
psizeVX9100 <- matrix(0, steps, 1)
psizeNOVX <- matrix(0, steps, 1)
psizeNOVX9 <- matrix(0, steps, 1)
psizeNOVX9100 <- matrix(0, steps, 1)

agepopall <- matrix(0, steps, Mnage)

psize04H <- matrix(0, steps, 1)
agepopHIV <- matrix(0, steps, Mnage)

artnum <- matrix(0, (yearend - year1 + 1), 2)
artsize <- matrix(0, steps, 2)

psize014H <- matrix(0, steps, 1)
psize1554H <- matrix(0, steps, 1)
psize5564H <- matrix(0, steps, 1)
psize65plusH <- matrix(0, steps, 1)

psizeVXH <- matrix(0, steps, 1)
psizeVX9H <- matrix(0, steps, 1)
psizeVX9100H <- matrix(0, steps, 1)

psize1559H <- matrix(0, steps, 1)
psize60plusH <- matrix(0, steps, 1)
psize15plusH <- matrix(0, steps, 1)
psize1549H <- matrix(0, steps, 1)

psize0509H <- matrix(0, steps, 1)
psize1019H <- matrix(0, steps, 1)
psize2029H <- matrix(0, steps, 1)
psize3039H <- matrix(0, steps, 1)
psize4049H <- matrix(0, steps, 1)
psize5059H <- matrix(0, steps, 1)
psize6069H <- matrix(0, steps, 1)
psize70plusH <- matrix(0, steps, 1)

psizematrix <- matrix(0, steps, 4)
Imatrix <- matrix(0, steps, 4)
BIRTHS <- vector("numeric", steps)
BIRTHSH <- vector("numeric", steps)
Imatno6080A <- matrix(0, steps, 1)
Imatno6080B <- matrix(0, steps, 1)
Imatno75up <- matrix(0, steps, 1)

psize[1] <- sum(S[1, ], L[1, ], R[1, ], I[1, ], NI[1, ], Sv[1, ], Lv[1, ], Iv[1, ], NIv[1, ], Rv[1, ])
psizeH[1] <- sum(SH[1, ], LH[1, ], RH[1, ], IH[1, ], NIH[1, ], SvH[1, ], LvH[1, ], IvH[1, ], NIvH[1, ], RvH[1, ])
psizeALL[1] <- sum(S[1, ], L[1, ], R[1, ], I[1, ], NI[1, ], Sv[1, ], Lv[1, ], Iv[1, ], NIv[1, ], Rv[1, ], SH[1, ], LH[1, ], RH[1, ], IH[1, ], NIH[1, ], SvH[1, ], LvH[1, ], IvH[1, ], NIvH[1, ], RvH[1, ])

psize014[1] <- sum(S[1, 1:15], L[1, 1:15], R[1, 1:15], I[1, 1:15], NI[1, 1:15], Sv[1, 1:15], Lv[1, 1:15], Iv[1, 1:15], NIv[1, 1:15], Rv[1, 1:15])
psize1554[1] <- sum(S[1, 16:55], L[1, 16:55], R[1, 16:55], I[1, 16:55], NI[1, 16:55], Sv[1, 16:55], Lv[1, 16:55], Iv[1, 16:55], NIv[1, 16:55], Rv[1, 16:55])
psize5564[1] <- sum(S[1, 56:65], L[1, 56:65], R[1, 56:65], I[1, 56:65], NI[1, 56:65], Sv[1, 56:65], Lv[1, 56:65], Iv[1, 56:65], NIv[1, 56:65], Rv[1, 56:65])
psize65plus[1] <- sum(S[1, 66:Mnage], L[1, 66:Mnage], R[1, 66:Mnage], I[1, 66:Mnage], NI[1, 66:Mnage], Sv[1, 66:Mnage], Lv[1, 66:Mnage], Rv[1, 66:Mnage], Iv[1, 66:Mnage], NIv[1, 66:Mnage])

psize1559[1] <- sum(S[1, 16:60], L[1, 16:60], R[1, 16:60], I[1, 16:60], NI[1, 16:60], Sv[1, 16:60], Lv[1, 16:60], Rv[1, 16:60], Iv[1, 16:60], NIv[1, 16:60])
psize1529[1] <- sum(S[1, 16:30], L[1, 16:30], R[1, 16:30], I[1, 16:30], NI[1, 16:30], Sv[1, 16:30], Lv[1, 16:30], Rv[1, 16:30], Iv[1, 16:30], NIv[1, 16:30])
psize3044[1] <- sum(S[1, 31:45], L[1, 31:45], R[1, 31:45], I[1, 31:45], NI[1, 31:45], Sv[1, 31:45], Lv[1, 31:45], Rv[1, 31:45], Iv[1, 31:45], NIv[1, 31:45])
psize4559[1] <- sum(S[1, 46:60], L[1, 46:60], R[1, 46:60], I[1, 46:60], NI[1, 46:60], Sv[1, 46:60], Lv[1, 46:60], Rv[1, 46:60], Iv[1, 46:60], NIv[1, 46:60])
psize60plus[1] <- sum(S[1, 61:Mnage], L[1, 61:Mnage], R[1, 61:Mnage], I[1, 61:Mnage], NI[1, 61:Mnage], Sv[1, 61:Mnage], Lv[1, 61:Mnage], Rv[1, 61:Mnage], Iv[1, 61:Mnage], NIv[1, 61:Mnage])
psize55plus[1] <- sum(S[1, 56:Mnage], L[1, 56:Mnage], R[1, 56:Mnage], I[1, 56:Mnage], NI[1, 56:Mnage], Sv[1, 56:Mnage], Lv[1, 56:Mnage], Rv[1, 56:Mnage], Iv[1, 56:Mnage], NIv[1, 56:Mnage])
psize55minus[1] <- sum(S[1, 1:55], L[1, 1:55], R[1, 1:55], I[1, 1:55], NI[1, 1:55], Sv[1, 1:55], Lv[1, 1:55], Rv[1, 1:55], Iv[1, 1:55], NIv[1, 1:55])

psize0509[1] <- sum(S[1, 6:10], L[1, 6:10], R[1, 6:10], I[1, 6:10], NI[1, 6:10], Sv[1, 6:10], Lv[1, 6:10], Rv[1, 6:10], Iv[1, 6:10], NIv[1, 6:10])
psize1019[1] <- sum(S[1, 11:20], L[1, 11:20], R[1, 11:20], I[1, 11:20], NI[1, 11:20], Sv[1, 11:20], Lv[1, 11:20], Rv[1, 11:20], Iv[1, 11:20], NIv[1, 11:20])
psize2029[1] <- sum(S[1, 21:30], L[1, 21:30], R[1, 21:30], I[1, 21:30], NI[1, 21:30], Sv[1, 21:30], Lv[1, 21:30], Rv[1, 21:30], Iv[1, 21:30], NIv[1, 21:30])
psize3039[1] <- sum(S[1, 31:40], L[1, 31:40], R[1, 31:40], I[1, 31:40], NI[1, 31:40], Sv[1, 31:40], Lv[1, 31:40], Rv[1, 31:40], Iv[1, 31:40], NIv[1, 31:40])
psize4049[1] <- sum(S[1, 41:50], L[1, 41:50], R[1, 41:50], I[1, 41:50], NI[1, 41:50], Sv[1, 41:50], Lv[1, 41:50], Rv[1, 41:50], Iv[1, 41:50], NIv[1, 41:50])
psize5059[1] <- sum(S[1, 51:60], L[1, 51:60], R[1, 51:60], I[1, 51:60], NI[1, 51:60], Sv[1, 51:60], Lv[1, 51:60], Rv[1, 51:60], Iv[1, 51:60], NIv[1, 51:60])
psize6069[1] <- sum(S[1, 61:70], L[1, 61:70], R[1, 61:70], I[1, 61:70], NI[1, 61:70], Sv[1, 61:70], Lv[1, 61:70], Rv[1, 61:70], Iv[1, 61:70], NIv[1, 61:70])
psize70plus[1] <- sum(S[1, 71:Mnage], L[1, 71:Mnage], R[1, 71:Mnage], I[1, 71:Mnage], NI[1, 71:Mnage], Sv[1, 71:Mnage], Lv[1, 71:Mnage], Rv[1, 71:Mnage], Iv[1, 71:Mnage], NIv[1, 71:Mnage])
psize5574[1] <- sum(S[1, 56:75], L[1, 56:75], R[1, 56:75], I[1, 56:75], NI[1, 56:75], Sv[1, 56:75], Lv[1, 56:75], Rv[1, 56:75], Iv[1, 56:75], NIv[1, 56:75])
psize75plus[1] <- sum(S[1, 76:Mnage], L[1, 76:Mnage], R[1, 76:Mnage], I[1, 76:Mnage], NI[1, 76:Mnage], Sv[1, 76:Mnage], Lv[1, 76:Mnage], Rv[1, 76:Mnage], Iv[1, 76:Mnage], NIv[1, 76:Mnage])
psize1524[1] <- sum(S[1, 16:25], L[1, 16:25], R[1, 16:25], I[1, 16:25], NI[1, 16:25], Sv[1, 16:25], Lv[1, 16:25], Rv[1, 16:25], Iv[1, 16:25], NIv[1, 16:25])
psize2554[1] <- sum(S[1, 26:55], L[1, 26:55], R[1, 26:55], I[1, 26:55], NI[1, 26:55], Sv[1, 26:55], Lv[1, 26:55], Rv[1, 26:55], Iv[1, 26:55], NIv[1, 26:55])
psize15plus[1] <- sum(S[1, 16:Mnage], L[1, 16:Mnage], R[1, 16:Mnage], I[1, 16:Mnage], NI[1, 16:Mnage], Sv[1, 16:Mnage], Lv[1, 16:Mnage], Rv[1, 16:Mnage], Iv[1, 16:Mnage], NIv[1, 16:Mnage])

psize1549[1] <- psize1559[1] - psize5059[1]

agepopall[1, 1:Mnage] <- S[1, 1:Mnage] + L[1, 1:Mnage] + R[1, 1:Mnage] + I[1, 1:Mnage] + NI[1, 1:Mnage] + Sv[1, 1:Mnage] + Lv[1, 1:Mnage] + Rv[1, 1:Mnage] + Iv[1, 1:Mnage] + NIv[1, 1:Mnage] + SH[1, 1:Mnage] + LH[1, 1:Mnage] + RH[1, 1:Mnage] + IH[1, 1:Mnage] + NIH[1, 1:Mnage] + SvH[1, 1:Mnage] + LvH[1, 1:Mnage] + RvH[1, 1:Mnage] + IvH[1, 1:Mnage] + NIvH[1, 1:Mnage]

psize04H[1] <- sum(SH[1, 1:5], LH[1, 1:5], RH[1, 1:5], IH[1, 1:5], NIH[1, 1:5], SvH[1, 1:5], LvH[1, 1:5], RvH[1, 1:5], IvH[1, 1:5], NIvH[1, 1:5])
agepopHIV[1, 1:Mnage] <- SH[1, 1:Mnage] + LH[1, 1:Mnage] + RH[1, 1:Mnage] + IH[1, 1:Mnage] + NIH[1, 1:Mnage] + SvH[1, 1:Mnage] + LvH[1, 1:Mnage] + RvH[1, 1:Mnage] + IvH[1, 1:Mnage] + NIvH[1, 1:Mnage]

psize014H[1] <- sum(SH[1, 1:15], LH[1, 1:15], RH[1, 1:15], IH[1, 1:15], NIH[1, 1:15], SvH[1, 1:15], LvH[1, 1:15], IvH[1, 1:15], NIvH[1, 1:15], RvH[1, 1:15])
psize1554H[1] <- sum(SH[1, 16:55], LH[1, 16:55], RH[1, 16:55], IH[1, 16:55], NIH[1, 16:55], SvH[1, 16:55], LvH[1, 16:55], IvH[1, 16:55], NIvH[1, 16:55], RvH[1, 16:55])
psize5564H[1] <- sum(SH[1, 56:65], LH[1, 56:65], RH[1, 56:65], IH[1, 56:65], NIH[1, 56:65], SvH[1, 56:65], LvH[1, 56:65], IvH[1, 56:65], NIvH[1, 56:65], RvH[1, 56:65])
psize65plusH[1] <- sum(SH[1, 66:Mnage], LH[1, 66:Mnage], RH[1, 66:Mnage], IH[1, 66:Mnage], NIH[1, 66:Mnage], SvH[1, 66:Mnage], LvH[1, 66:Mnage], RvH[1, 66:Mnage], IvH[1, 66:Mnage], NIvH[1, 66:Mnage])

psizeVXH[1] <- sum(SvH[1, ], LvH[1, ], RvH[1, ], IvH[1, ], NIvH[1, ])
psizeVX9H[1] <- sum(SvH[1, 10], LvH[1, 10], IvH[1, 10], NIvH[1, 10], RvH[1, 10])
psizeVX9100H[1] <- sum(SvH[1, 10:101], LvH[1, 10:101], IvH[1, 10:101], NIvH[1, 10:101], RvH[1, 10:101])

psize1559H[1] <- sum(SH[1, 16:60], LH[1, 16:60], RH[1, 16:60], IH[1, 16:60], NIH[1, 16:60], SvH[1, 16:60], LvH[1, 16:60], RvH[1, 16:60], IvH[1, 16:60], NIvH[1, 16:60])
psize60plusH[1] <- sum(SH[1, 61:Mnage], LH[1, 61:Mnage], RH[1, 61:Mnage], IH[1, 61:Mnage], NIH[1, 61:Mnage], SvH[1, 61:Mnage], LvH[1, 61:Mnage], RvH[1, 61:Mnage], IvH[1, 61:Mnage], NIvH[1, 61:Mnage])
psize15plusH[1] <- sum(SH[1, 16:Mnage], LH[1, 16:Mnage], RH[1, 16:Mnage], IH[1, 16:Mnage], NIH[1, 16:Mnage], SvH[1, 16:Mnage], LvH[1, 16:Mnage], RvH[1, 16:Mnage], IvH[1, 16:Mnage], NIvH[1, 16:Mnage])

psize0509H[1] <- sum(SH[1, 6:10], LH[1, 6:10], RH[1, 6:10], IH[1, 6:10], NIH[1, 6:10], SvH[1, 6:10], LvH[1, 6:10], RvH[1, 6:10], IvH[1, 6:10], NIvH[1, 6:10])
psize1019H[1] <- sum(SH[1, 11:20], LH[1, 11:20], RH[1, 11:20], IH[1, 11:20], NIH[1, 11:20], SvH[1, 11:20], LvH[1, 11:20], RvH[1, 11:20], IvH[1, 11:20], NIvH[1, 11:20])
psize2029H[1] <- sum(SH[1, 21:30], LH[1, 21:30], RH[1, 21:30], IH[1, 21:30], NIH[1, 21:30], SvH[1, 21:30], LvH[1, 21:30], RvH[1, 21:30], IvH[1, 21:30], NIvH[1, 21:30])
psize3039H[1] <- sum(SH[1, 31:40], LH[1, 31:40], RH[1, 31:40], IH[1, 31:40], NIH[1, 31:40], SvH[1, 31:40], LvH[1, 31:40], RvH[1, 31:40], IvH[1, 31:40], NIvH[1, 31:40])
psize4049H[1] <- sum(SH[1, 41:50], LH[1, 41:50], RH[1, 41:50], IH[1, 41:50], NIH[1, 41:50], SvH[1, 41:50], LvH[1, 41:50], RvH[1, 41:50], IvH[1, 41:50], NIvH[1, 41:50])
psize5059H[1] <- sum(SH[1, 51:60], LH[1, 51:60], RH[1, 51:60], IH[1, 51:60], NIH[1, 51:60], SvH[1, 51:60], LvH[1, 51:60], RvH[1, 51:60], IvH[1, 51:60], NIvH[1, 51:60])
psize6069H[1] <- sum(SH[1, 61:70], LH[1, 61:70], RH[1, 61:70], IH[1, 61:70], NIH[1, 61:70], SvH[1, 61:70], LvH[1, 61:70], RvH[1, 61:70], IvH[1, 61:70], NIvH[1, 61:70])
psize70plusH[1] <- sum(SH[1, 71:Mnage], LH[1, 71:Mnage], RH[1, 71:Mnage], IH[1, 71:Mnage], NIH[1, 71:Mnage], SvH[1, 71:Mnage], LvH[1, 71:Mnage], RvH[1, 71:Mnage], IvH[1, 71:Mnage], NIvH[1, 71:Mnage])

psize1549H[1] <- psize1559H[1] - psize5059H[1]

psizematrix[1, 1] <- sum(S[1, 1:5], L[1, 1:5], R[1, 1:5], I[1, 1:5], NI[1, 1:5], Sv[1, 1:5], Lv[1, 1:5], Rv[1, 1:5], Iv[1, 1:5], NIv[1, 1:5], SH[1, 1:5], LH[1, 1:5], RH[1, 1:5], IH[1, 1:5], NIH[1, 1:5], SvH[1, 1:5], LvH[1, 1:5], RvH[1, 1:5], IvH[1, 1:5], NIvH[1, 1:5])
psizematrix[1, 2] <- sum(S[1, 6:10], L[1, 6:10], R[1, 6:10], I[1, 6:10], NI[1, 6:10], Sv[1, 6:10], Lv[1, 6:10], Rv[1, 6:10], Iv[1, 6:10], NIv[1, 6:10], SH[1, 6:10], LH[1, 6:10], RH[1, 6:10], IH[1, 6:10], NIH[1, 6:10], SvH[1, 6:10], LvH[1, 6:10], RvH[1, 6:10], IvH[1, 6:10], NIvH[1, 6:10])
psizematrix[1, 3] <- sum(S[1, 11:15], L[1, 11:15], R[1, 11:15], I[1, 11:15], NI[1, 11:15], Sv[1, 11:15], Lv[1, 11:15], Rv[1, 11:15], Iv[1, 11:15], NIv[1, 11:15], SH[1, 11:15], LH[1, 11:15], RH[1, 11:15], IH[1, 11:15], NIH[1, 11:15], SvH[1, 11:15], LvH[1, 11:15], RvH[1, 11:15], IvH[1, 11:15], NIvH[1, 11:15])
psizematrix[1, 4] <- sum(S[1, 16:Mnage], L[1, 16:Mnage], R[1, 16:Mnage], I[1, 16:Mnage], NI[1, 16:Mnage], Sv[1, 16:Mnage], Lv[1, 16:Mnage], Rv[1, 16:Mnage], Iv[1, 16:Mnage], NIv[1, 16:Mnage], SH[1, 16:Mnage], LH[1, 16:Mnage], RH[1, 16:Mnage], IH[1, 16:Mnage], NIH[1, 16:Mnage], SvH[1, 16:Mnage], LvH[1, 16:Mnage], RvH[1, 16:Mnage], IvH[1, 16:Mnage], NIvH[1, 16:Mnage])

Imatrix[1, 1] <- sum(I[1, 1:5], Iv[1, 1:5], IH[1, 1:5], IvH[1, 1:5])
Imatrix[1, 2] <- sum(I[1, 6:10], Iv[1, 6:10], IH[1, 6:10], IvH[1, 6:10])
Imatrix[1, 3] <- sum(I[1, 11:15], Iv[1, 11:15], IH[1, 11:15], IvH[1, 11:15])
Imatrix[1, 4] <- sum(I[1, 16:Mnage], Iv[1, 16:Mnage], IH[1, 16:Mnage], IvH[1, 16:Mnage])

lambda <- matrix(0, steps, Mnage)
lambda[1, 1:Mnage] <- t(neta * (1 - exp(colSums(-(myneta[1:4, 1:Mnage]) * z * ((Imatrix[1, 1:4]) / (psizematrix[1, 1:4]))))))

birthsnum <- matrix(0, steps, 1)
bv <- c()
brate <- c()
trackbirths <- c()

ADeaths <- matrix(0, steps, Mnage)
ADeathsH <- matrix(0, steps, Mnage)
ADeathsN <- matrix(0, steps, Mnage)
TBDeaths <- matrix(0, steps, Mnage)
TBDeathsN <- matrix(0, steps, Mnage)
TBDeathsH <- matrix(0, steps, Mnage)
AIDSdeaths <- matrix(0, steps, Mnage)
BKdeaths <- matrix(0, steps, Mnage)
alldeath <- matrix(0, steps, Mnage)

VX <- matrix(0, steps, 3)
vaccgive <- matrix(0, 1, 5)
vaccgiveyr <- matrix(0, 1, 26)
NNV <- matrix(0, 12, 8)

HIVP <- matrix(0, steps, 4)
TBRx <- matrix(0, steps, 2)
TBI <- matrix(0, steps, 10)
TBIH <- matrix(0, steps, 3)
TBIHda <- matrix(0, steps, 3)
TBIall <- matrix(0, steps, 3)
TBIpcHIV <- matrix(0, steps, 1)
TBM <- matrix(0, steps, 11)
TBMHda <- matrix(0, steps, 1)
TBP <- matrix(0, steps, 7)
TBPall <- matrix(0, steps, 1)
TBPHda <- matrix(0, steps, 3)
TBPb <- matrix(0, steps, 9)
TBPI <- matrix(0, steps, 17)
PSIZEy <- matrix(0, steps, 25)
PSIZEyH <- matrix(0, steps, 19)
TBRa <- matrix(0, steps, 8)
TBRa2 <- matrix(0, steps, 8)
TBRi <- matrix(0, steps, 8)
TBRi2 <- matrix(0, steps, 8)
TBInew <- matrix(0, steps, 6)
TBProp <- matrix(0, steps, 4)
TBN <- matrix(0, steps, 8)
TBNHda <- matrix(0, steps, 3)
TBNall <- matrix(0, steps, 3)

ARI <- matrix(0, steps, 4)
TBAc <- matrix(0, (yearend - year1 + 1), 3)
TBAc_age <- matrix(0, (yearend - year1 + 1), 6)
TBMo <- matrix(0, (yearend - year1 + 1), 1)
NV <- matrix(0, (yearend - year1 + 1), 1)
TBP_age <- matrix(0, (yearend - year1 + 1), Mnage)
TBPH_age <- matrix(0, (yearend - year1 + 1), Mnage)
TBMo_age <- matrix(0, (yearend - year1 + 1), Mnage)
newinc <- matrix(0, (yearend - year1 + 1), 1)
newtreat <- matrix(0, (yearend - year1 + 1), 3)
TBPIage <- matrix(0, (yearend - year1 + 1), Mnage)
COVtot <- matrix(0, (yearend - year1 + 1), 1)
COVtottest <- matrix(0, (yearend - year1 + 1), 1)
COV9 <- matrix(0, (yearend - year1 + 1), 1)
COV9100 <- matrix(0, (yearend - year1 + 1), 1)
COVage <- matrix(0, (yearend - year1 + 1), Mnage)

colnames(TBI) <- c("All ages", "0-14", "15-54", "55-64", "65+", "55+", "<55", "15-24", "25-54", "15+")
colnames(TBN) <- c("All ages", "0-14", "15-54", "55-64", "65+", "55+", "<55", "15+")
colnames(TBM) <- c("All ages", "0-14", "15-54", "55-64", "65+", "15-59", "60+", "55+", "<55", "15-24", "25-54")
colnames(TBP) <- c("All ages", "0-14", "15-29", "30-44", "45-59", "60+", "55+")
colnames(TBPb) <- c("All ages", "0-14", "15-29", "30-44", "45-59", "60+", "55+", "15+", "30-59")
colnames(TBPI) <- c("All ages", "0-14", "15-54", "55-64", "65+", "55+", "5-9", "10-19", "20-29", "30-39", "40-49", "50-59", "60-69", "70+", "6574", "75+", "1524")
colnames(PSIZEy) <- c("All ages", "0-14", "15-54", "55-64", "65+", "15-59", "15-29", "30-44", "45-59", "60+", "55+", "5-9", "10-19", "20-29", "30-39", "40-49", "50-59", "60-69", "70+", "55-74", "75+", "15-24", "25-54", "15+", "1549")

I2050 <- matrix(0, 5, 1)
CDR_av <- matrix(0, (yearend - year1), 1)

totmort <- matrix(0, 1, 4)
totmortyr <- matrix(0, (steps * dt), 4)
colnames(totmort) <- c("All ages", "65+", "55+", "<55")

totcase <- matrix(0, 1, 4)
totcaseyr <- matrix(0, (steps * dt), 4)
colnames(totcase) <- c("All ages", "65+", "55+", "<55")

cumuloutyr <- matrix(0, 26, 8)

upopstore <- matrix(0, steps, Mnage)
uHpopstore <- matrix(0, steps, Mnage)
ustore <- matrix(0, steps, Mnage)
uHstore <- matrix(0, steps, Mnage)
